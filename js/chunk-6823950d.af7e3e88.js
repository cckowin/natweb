(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6823950d"],{"6fcd":function(t,e,a){},"9c43":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-document-checked"}),t._v(" 任务管理 ")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"mr10",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.addJob}},[t._v("添加任务")]),a("el-select",{staticClass:"handle-select mr10",attrs:{clearable:"",placeholder:"采集单位"},model:{value:t.query.groupid,callback:function(e){t.$set(t.query,"groupid",e)},expression:"query.groupid"}},t._l(t.groups,(function(t,e){return a("el-option",{key:e,attrs:{label:t.username,value:t.id}})})),1),a("el-select",{staticClass:"handle-select mr10",attrs:{clearable:"",placeholder:"任务状态"},model:{value:t.query.status,callback:function(e){t.$set(t.query,"status",e)},expression:"query.status"}},[a("el-option",{key:"0",attrs:{label:"采集中",value:"0"}}),a("el-option",{key:"1",attrs:{label:"已完成",value:"1"}})],1),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.getData}},[t._v("搜索")])],1),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:t.tableData,border:"","header-cell-class-name":"table-header"}},[a("el-table-column",{attrs:{prop:"group",label:"采集单位",align:"center"}}),a("el-table-column",{attrs:{prop:"jobname",label:"任务名称",align:"center"}}),a("el-table-column",{attrs:{label:"任务状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.status?a("el-tag",{attrs:{size:"medium"}},[t._v("采集中")]):1===e.row.status?a("el-tag",{attrs:{size:"medium",type:"success"}},[t._v("已完成")]):t._e()]}}])}),a("el-table-column",{attrs:{label:"操作",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.status?a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-circle-check"},on:{click:function(a){return t.handleFinish(e.row)}}},[t._v("完成")]):t._e()]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[20,30,50,100],"page-size":20,background:"",layout:"total, sizes, prev, pager, next",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),a("el-dialog",{attrs:{title:"添加任务",visible:t.addVisible,width:"30%"},on:{"update:visible":function(e){t.addVisible=e}}},[a("el-form",{ref:"form",attrs:{rules:t.rules,model:t.form,"label-width":"100px"}},[a("el-form-item",{attrs:{prop:"jobname",label:"任务名称"}},[a("el-input",{attrs:{placeholder:"请输入任务名称"},model:{value:t.form.jobname,callback:function(e){t.$set(t.form,"jobname",e)},expression:"form.jobname"}})],1),a("el-form-item",{attrs:{prop:"groupid",label:"所属单位"}},[a("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"所属单位"},model:{value:t.form.groupid,callback:function(e){t.$set(t.form,"groupid",e)},expression:"form.groupid"}},t._l(t.groups,(function(t,e){return a("el-option",{key:e,attrs:{label:t.username,value:t.id}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.cancel}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.sumbitJob}},[t._v("确 定")])],1)],1)],1)},l=[],i={name:"jobManage",data:function(){return{rules:{jobname:[{required:!0,message:"请输入任务名称",trigger:"blur"}],groupid:[{required:!0,message:"请选择所属单位",trigger:"blur"}]},form:{},addVisible:!1,query:{groupid:null,status:null},tableData:[],pageSize:20,currentPage:1,total:50,groups:null}},created:function(){this.getData(),this.getGroupData()},methods:{handleFinish:function(t){var e=this;this.$confirm("确定要将任务状态设置为已完成吗？采集端将看不到该任务","提示",{type:"warning"}).then((function(){e.axios.post("/admin/finishJob",e.qs.stringify({jobid:t.jobid})).then((function(t){e.getData(),t.data.flag?e.$message.success(t.data.msg):e.$message.error(t.data.msg)})).catch((function(t){console.log(t)}))})).catch((function(){})),console.log(t)},cancel:function(){this.addVisible=!1,this.getData()},sumbitJob:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return t.$message.error("请填写完整"),!1;t.axios.post("/admin/addJob",t.qs.stringify({groupid:t.form.groupid,jobname:t.form.jobname})).then((function(e){t.getData(),t.addVisible=!1,e.data.flag?t.$message.success(e.data.msg):t.$message.error(e.data.msg)})).catch((function(t){console.log(t)}))}))},addJob:function(){this.form=[],this.addVisible=!0},getGroupData:function(){var t=this;this.axios.post("/admin/getGroup").then((function(e){e.data.flag&&(t.groups=e.data.data)})).catch((function(t){console.log(t)}))},getData:function(){var t=this;this.axios.post("/admin/getJobData",this.qs.stringify({groupid:this.query.groupid,status:this.query.status,pageNum:this.currentPage,pageSize:this.pageSize})).then((function(e){e.data.flag?(t.tableData=e.data.data.list,t.total=e.data.data.total):t.tableData=e.data.data})).catch((function(t){console.log(t)}))},handleSizeChange:function(t){this.pageSize=t,this.getData()},handleCurrentChange:function(t){this.currentPage=t,this.getData()}}},o=i,n=(a("ad01"),a("2877")),r=Object(n["a"])(o,s,l,!1,null,"41974294",null);e["default"]=r.exports},ad01:function(t,e,a){"use strict";a("6fcd")}}]);
//# sourceMappingURL=chunk-6823950d.af7e3e88.js.map